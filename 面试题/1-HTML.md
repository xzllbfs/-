## 浏览器

## 基础

1. 异步加载JS脚本的方式有哪些？
   1. 动态创建 `script` 标签
   2. XHR 异步加载JS
2. `defer` 和 `async` 的区别
   - defer 要等到整个页面在内存中正常渲染结束（DOM 结构完全生成，以及其他脚本执行完成），在window.onload 之前执行；
   - async 一旦下载完，渲染引擎就会中断渲染，执行这个脚本以后，再继续渲染。
   - 如果有多个 `defer` 脚本，会按照它们在页面出现的顺序加载
   - 多个 `async` 脚本不能保证加载顺序
3. 浏览器有哪些进程？
   1. 主进程：负责浏览器界面显示；各个页面的管理，创建以及销毁；将渲染进程的结果绘制到用户界面上；网络资源管理
   2. GPU 进程：用于 3D 渲染绘制
   3. 网络进程：发起网络请求
   4. 插件进程：第三方插件处理，运行在沙箱中
   5. 渲染进程：页面渲染、脚本执行、事件处理
4. **一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？**
   1. 用户输入过程中，浏览器进行下拉联想，根据历史记录补全url，或者添加http协议头
   2. 判断强缓存：是否存在未过期的缓存，如果存在直接渲染页面，否则发起网络请求
   3. 网络请求阶段：
      1. DNS解析域名，读取缓存的ip地址，向服务端发起请求
      2. 建立TCP连接
      3. 浏览器发送get请求
      4. 服务端如果负载均衡的服务器，就会分发给具体的服务器
      5. 返回数据，浏览器根据状态码确认缓存方式(判断协商缓存)
         - 304-读取缓存文件
         - 200-覆盖or创建新的缓存文件
   4. 如果文件是html，开始渲染页面
   5. 页面渲染阶段：
      1. 处理HTML标记，通过HTML Parser+CSS Parser 构建 DOM Tree + CSSOM Tree
         - Doctype：浏览器通过判断文档类型来决定用什么模式来解析，以及切换浏览器模式
         - meta：用来定义的元信息：渲染模式，SEO相关信息
         - title：显示页面标题
         - link：通过href加载或解析外链资源，主要是css
         - style：正常情况下，css不会阻塞DOM树渲染，除非有通过@import动态导入的样式才会阻塞
         - script：正常情况下，js会阻塞页面渲染，除了外链的js添加defer属性
         - img：不会阻塞DOM渲染，但是如果没有设置宽高，加载完成后会触发DOM回流
      2. 整合渲染树：DOM Tree + CSSOM Tree = Render Tree
      3. 布局=>回流/重排：根据渲染树，计算它们在设备视口内的确切位置和大小，生成layout Tree
      4. Painting：根据渲染树和回流得到的几何信息和节点的绝对像素绘制GUI，将图层转换为位图
      5. display：将内容都呈现出来，展示给用户
   6. 静置一段时间后关闭TCP连接

## HTML

1. 浏览器的渲染过程？

   1. 处理HTML标记，通过HTML Parser 构建DOM Tree
   2. 处理CSS标记，通过 CSS Parser 构建 CSSOM Tree
   3. 整合渲染树：DOM Tree + CSSOM Tree = Render Tree
   4. 回流=>布局/重排：根据渲染树，计算它们在设备视口内的确切位置和大小
   5. Painting：根据渲染树和回流得到的几何信息和节点的绝对像素进行绘制
   6. display：将内容都呈现出来，展示给用户

2. 浏览器解析html标签的具体过程？

   html标签的解析过程是在GUI渲染线程中进行的。

   1. Doctype：浏览器通过判断文档类型来决定用什么模式来解析，以及切换浏览器模式
   2. Meta：用来定义的元信息：渲染模式，SEO相关信息
   3. title：显示页面标题
   4. Link：通过href加载或解析外链资源，主要是样式
   5. CSS
      - link外链式 ：不阻塞DOM 树渲染，开辟HTTP线程加载资源
      - style内嵌式：不阻塞DOM树渲染，先记录下来，等所有css资源加载成功后，按照顺序依次渲染生成CSSOM树
      - @import导入式：阻塞DOM树渲染，开辟HTTP线程加载资源，资源加载回来，才会继续渲染
   6. script
      - 内嵌式：阻塞DOM树渲染，立即执行js
      - 普通外链式：阻塞DOM树渲染，同时开辟HTTP线程加载资源，加载回来后立即执行js
      - async外链式：开辟HTTP线程加载资源，继续渲染Dom树，加载完成停止DOM渲染，先执行js（不考虑导入顺序，按照加载回来的先后顺序执行）
      - defer外链式：开辟HTTP线程加载资源，等待DOM树渲染完，按照js导入顺序依次执行js
   7. img：不会阻塞DOM渲染，开辟HTTP线程加载src，加载回来后如果没有设置宽高会触发回流

3. 什么回流Reflow？触发机制有哪些？

   DOM结构中各个元素都有自己的盒模型，需要浏览器根据样式计算结果将元素放置在它该出现的位置上，这个过程称之为回流。

   **触发机制**

   - 增删改元素时，导致重绘和回流
   - 移动DOM位置或添加动画时
   - 修改css样式时
   - 浏览器窗口缩放Resize时，滚动页面时
   - 修改网页的默认字体时

4. 什么重绘Repaint？触发机制有哪些？

   当各种盒子的位置、大小、颜色、字体等确定之后，浏览器按照各自的特性绘制后呈现在在页面上，这个过程叫重绘。

   **触发机制**

   - Dom改动
   - Css改动

   **回流必将引起重绘，而重绘不一定会引起回流**

5. 什么是Doctype，它的作用是什么？传统模式和严格模式的区别？

   DTD（document type definition，文档类型定义）是一系列的语法规则，用来定义XML或XHTML的文件类型。浏览器会使用它来判断文档类型，决定使用何种模式来解析，以及切换浏览器模式。

   DOCTYPE是用来声明文档类型定义规范的，一个主要的用途就是验证文件的合法性。如果不合法，浏览器解析会出错。

   **DTD（文档类型定义）定义了一些文档类型，DOCTYPE将类型告诉浏览器，浏览器根据它来决定用什么模式来解析，以及切换浏览器模式。**

   传统模式：包含所有HTML元素和属性，**不包括**展示性和弃用的元素

   严格模式：包含所有HTML元素和属性，**包括**展示性和弃用的元素（浏览器能正常解析）

6. meta标签的viewport对应的content有哪些属性？

   1.  width：设置 viewport 的宽度，正整数/字符串 device-width
   2.  height：设置 viewport 的高度，正整数/字符串 device-height
   3.  initial-scale：设置设备宽度与 viewport大小之间的缩放比例，0.0-10.0之间的正数
   4.  maximum-scale：设置最大缩放系数，0.0-10.0之间的正数
   5.  minimum-scale：设置最小缩放系数，0.0-10.0之间的正数
   6.  user-scalable：如果设置为 no 用户将不能缩放网页，默认为 yes，yes / no

7. 如何理解HTML语义化？

   HTML语义化可以增加代码可读性，有利于搜索引擎优化（SEO）

8. 哪些Html标签是块级元素，哪些是内联元素？

   - 块状元素指的是display:block/table 的元素，特点内容是可以**独占一行**。其中包括：div h1-h6 table ul ol p，pre
   - 内联元素指的是display:inline/inline-block的元素，特点是内容**依次连接直至浏览器的边缘换行**为止。其中包括：span img input button i figure
   
9. 异步加载js的方式

